# Множественная Регрессия (Лабораторная работа 3)

## 1. Введение

**Цель работы:** Разработка, оценка и выбор наиболее точной модели множественной линейной регрессии для прогнозирования Процента выпускников (Grad_Rate) на основе данных о колледжах.

### Переменные исследования

| Переменная | Описание | Тип |
|------------|----------|-----|
| **Y: Grad_Rate** | Процент выпускников (целевая переменная) | Количественная |
| **X1: Expend** | Расходы на одного студента | Количественная |
| **X2: P_Undergrad** | Численность студентов-заочников | Количественная |
| **X3: Private** | Частный колледж (1 - Да, 0 - Нет) | Бинарная |

---

## 2. Подготовка данных и предварительный анализ

### 2.1 Разделение выборки
- **Обучение:** 80%
- **Тестирование:** 20%

### 2.2 Пропуски данных
Пропуски в данных отсутствуют.

### 2.3 Корреляционный анализ
Наибольшая положительная линейная связь `Grad_Rate` наблюдается с:
- **Expend:** 0.38
- **Private:** 0.32

### 2.4 Проверка на нормальность
- Гипотеза о нормальности `Grad_Rate` отклонена
- Выполнено логарифмирование целевой переменной: `log(Y) = log(Grad_Rate)`

---

## 3. Спецификация и оценка моделей

Для обеих целевых переменных (**Y** и **log(Y)**) рассмотрен набор из 4 моделей-кандидатов, включающих различные комбинации предикторов.

**Метод оценки точности:** LOOCV.

### 3.1 Лучшие модели по Cross-Validation MSE (CV MSE)

| Целевая переменная | Лучшая спецификация | Формула | MSE |
|---------------------|---------------------|---------|---------|
| **Y** | Модель 2 | `Grad_Rate = log_Expend + P_Undergrad + Private` | 232.13 |
| **log(Y)** | Модель 2, 3, 4 | `ln(Grad_Rate) = log_Expend + P_Undergrad + Private` | 0.076 |

---

## 4. Прогноз и выбор финальной модели

Прогноз выполнен на отложенных наблюдениях (20% выборки), точность оценена с помощью MSE_test.

| Модель | MSE_test |
|--------|----------|
| Лучшая для Y (fit_lm_2) | 232.13 |
| Лучшая для log(Y) (fit_log_lm_(2, 3, 4)) | 0.076 |

### Вывод по точности
**Наиболее точной моделью является Модель 2 на исходной переменной Y (fit_lm_2)** с минимальным MSE_test = 232.13. Относительная ошибка прогноза этой модели составляет 20.9% от среднего значения Grad_Rate.

---

## 5. Интерпретация финальной модели

### Финальная выбранная модель:

```
Grad_Rate = 15.35 - 0.0015*Expend + 5.59*Private
```

### Интерпретация параметров

| Параметр | Значение | Интерпретация |
|----------|----------|---------------|
| **Intercept** | 15.35 | Ожидаемый процент выпускников для нечастного колледжа (Private=0) с нулевыми расходами на студента |
| **Expend (β₁)** | - 0.0015 | Увеличение расходов на одного студента на 1 у.е. (например, $1) связано с ожидаемым увеличением процента выпускников на 0.0015 процентных пункта, при прочих равных условиях |
| **Private (β₂)** | 5.59 | Частные колледжи (по сравнению с нечастными) имеют ожидаемый процент выпускников на 5.59 процентных пункта выше, при прочих равных условиях |
---

## Резюме

Проведенный анализ показал, что наиболее эффективной моделью для прогнозирования процента выпускников является простая модель с тремя предикторами: `Grad_Rate = log_Expend + P_Undergrad + Private`. Данная модель демонстрирует высокую точность прогнозирования (MSE_test = 232.13) и позволяет сделать вывод о значимом влиянии статуса учебного заведения на процент выпускников, однако влияние расхода достаточно низкое, что говорит о необходимости дополнительной проверки.

